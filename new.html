<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="apple-mobile-web-app-status-bar" content="#FAFAFA">
		<meta name="description" content="Finance">
		<meta name="author" content="Kushagra Karira, ChatGPT">
		<link rel="manifest" href="manifest.webmanifest" crossorigin="use-credentials">
		<link rel="apple-touch-icon" href="favicon.svg">
		<link rel="icon" href="favicon.svg" type="image/svg+xml">
		<meta name="theme-color" content="#FAFAFA">
		<link rel="stylesheet" href="style.css" type="text/css">
    <title>List of Indian Companies with IPO in Last Month</title>
  </head>
			<body>
    <h1>List of Indian Companies with IPO in Last Month</h1>

    <table>
      <thead>
        <tr>
          <th>Company Name</th>
          <th>IPO Date</th>
          <th>Exchange</th>
        </tr>
      </thead>
      <tbody id="ipo-list"></tbody>
    </table>

    <script>
      // Get the current date and subtract 1 month
      const currentDate = new Date();
      const lastMonthDate = new Date();
      lastMonthDate.setMonth(currentDate.getMonth() - 1);

      // Format the dates as YYYYMMDD for use with the NSE API
      const currentDateStr = currentDate.toISOString().slice(0, 10).replace(/-/g, "");
      const lastMonthDateStr = lastMonthDate.toISOString().slice(0, 10).replace(/-/g, "");

      // Build the URL for the NSE API
      const url = `https://www.nseindia.com/api/ipo/get-ipo-details?index=equity&from_date=${lastMonthDateStr}&to_date=${currentDateStr}`;

      fetch(url, {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          "Accept": "application/json",
          "Referer": "https://www.nseindia.com/ipo/ipo-list",
          "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36"
        }
      })
        .then(response => response.json())
        .then(data => {
          const ipoList = document.getElementById("ipo-list");
          data.forEach(entry => {
            const ipoDate = new Date(entry.ipoDate);
            if (ipoDate >= lastMonthDate && ipoDate <= currentDate && entry.totalIssueSize !== 0) {
              const row = document.createElement("tr");
              const companyName = document.createElement("td");
              companyName.textContent = entry.issuerName;
              const ipoDateCell = document.createElement("td");
              ipoDateCell.textContent = ipoDate.toLocaleDateString("en-IN");
              const exchange = document.createElement("td");
              exchange.textContent = entry.exchangeName;
              row.append(companyName, ipoDateCell, exchange);
              ipoList.appendChild(row);
            }
          });
        })
        .catch(error => console.error(error));
    </script>
  </body>
</html>
